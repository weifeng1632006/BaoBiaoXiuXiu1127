
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>多树目录管理系统</title>
  <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://unpkg.com/vue@3"></script>
  <script src="https://unpkg.com/element-plus"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
    }
    
    .header {
      text-align: center;
      margin-bottom: 30px;
      color: white;
      padding: 20px;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }
    
    .header h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
    }
    
    .header p {
      font-size: 1.2rem;
      opacity: 0.9;
    }
    
    .controls {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }
    
    .search-box {
      width: 400px;
    }
    
    .trees-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
      gap: 30px;
    }
    
    .tree-card {
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
      padding: 25px;
      transition: all 0.3s ease;
    }
    
    .tree-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
    }
    
    .tree-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid #f0f0f0;
    }
    
    .tree-title {
      font-size: 1.5rem;
      font-weight: bold;
      color: #303133;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .tree-title i {
      color: #409eff;
    }
    
    .tree-actions {
      display: flex;
      gap: 10px;
    }
    
    .action-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #ecf5ff;
      color: #409eff;
      cursor: pointer;
      transition: all 0.3s ease;
      border: none;
      font-size: 14px;
    }
    
    .action-btn:hover {
      background: #409eff;
      color: white;
      transform: scale(1.1);
    }
    
    .el-tree {
      background: transparent !important;
    }
    
    .el-tree-node__content {
      border-radius: 8px;
      margin: 2px 0;
      transition: all 0.2s ease;
    }
    
    .el-tree-node__content:hover {
      background-color: #f5f7fa !important;
    }
    
    .el-input__wrapper {
      border-radius: 25px !important;
    }
    
    .el-button {
      border-radius: 25px !important;
    }
    
    @media (max-width: 768px) {
      .trees-container {
        grid-template-columns: 1fr;
      }
      
      .search-box {
        width: 100%;
      }
      
      .controls {
        flex-direction: column;
        align-items: center;
      }
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="container">
      <div class="header">
        <h1><i class="fas fa-folder-tree"></i> 多树目录管理系统</h1>
        <p>支持多树结构展示、统一搜索与收缩控制</p>
      </div>
      
      <div class="controls">
        <el-input
          v-model="searchText"
          placeholder="请输入关键词搜索所有树节点..."
          class="search-box"
          clearable
          @input="handleSearch"
        >
          <template #prefix>
            <i class="fas fa-search"></i>
          </template>
        </el-input>
        
        <el-button 
          type="primary" 
          @click="toggleAllTrees"
          :icon="allExpanded ? 'arrow-down-bold' : 'arrow-right-bold'"
        >
          {{ allExpanded ? '全部收缩' : '全部展开' }}
        </el-button>
      </div>
      
      <div class="trees-container">
        <div class="tree-card" v-for="(tree, index) in treeData" :key="index">
          <div class="tree-header">
            <div class="tree-title">
              <i :class="tree.icon"></i>
              {{ tree.title }}
            </div>
            <div class="tree-actions">
              <button 
                class="action-btn" 
                @click="toggleTree(index)"
                :title="tree.expanded ? '收缩' : '展开'"
              >
                <i :class="tree.expanded ? 'fas fa-compress-alt' : 'fas fa-expand-alt'"></i>
              </button>
            </div>
          </div>
          
          <el-tree
            :ref="el => setTreeRef(el, index)"
            :data="tree.data"
            :props="defaultProps"
            :default-expanded-keys="tree.expandedKeys"
            :filter-node-method="filterNode"
            node-key="id"
            highlight-current
            @node-click="handleNodeClick"
          ></el-tree>
        </div>
      </div>
    </div>
  </div>

  <script>
    const { createApp, ref, nextTick } = Vue;
    const { ElTree, ElInput, ElButton } = ElementPlus;
    
    createApp({
      setup() {
        // 搜索文本
        const searchText = ref('');
        
        // 树展开状态
        const allExpanded = ref(true);
        
        // 树引用集合
        const treeRefs = ref([]);
        
        // 设置树引用
        const setTreeRef = (el, index) => {
          if (el) {
            treeRefs.value[index] = el;
          }
        };
        
        // 树数据
        const treeData = ref([
          {
            title: '项目文档目录',
            icon: 'fas fa-book',
            expanded: true,
            expandedKeys: [],
            data: [
              {
                id: '1',
                label: '需求文档',
                children: [
                  { id: '1-1', label: '用户需求说明书.docx' },
                  { id: '1-2', label: '功能规格说明.docx' },
                  { id: '1-3', label: '系统架构需求.pdf' }
                ]
              },
              {
                id: '2',
                label: '设计文档',
                children: [
                  { id: '2-1', label: 'UI设计稿.fig' },
                  { 
                    id: '2-2', 
                    label: '技术架构',
                    children: [
                      { id: '2-2-1', label: '前端架构.md' },
                      { id: '2-2-2', label: '后端架构.md' },
                      { id: '2-2-3', label: '数据库设计.sql' }
                    ]
                  },
                  { id: '2-3', label: 'API接口文档.yaml' }
                ]
              },
              {
                id: '3',
                label: '测试文档',
                children: [
                  { id: '3-1', label: '测试计划.docx' },
                  { id: '3-2', label: '测试用例.xlsx' },
                  { id: '3-3', label: '测试报告.pdf' }
                ]
              }
            ]
          },
          {
            title: '源代码目录',
            icon: 'fas fa-code',
            expanded: true,
            expandedKeys: [],
            data: [
              {
                id: '4',
                label: '前端代码',
                children: [
                  { id: '4-1', label: 'index.html' },
                  { 
                    id: '4-2', 
                    label: 'src',
                    children: [
                      { id: '4-2-1', label: 'main.js' },
                      { id: '4-2-2', label: 'App.vue' },
                      { 
                        id: '4-2-3', 
                        label: 'components',
                        children: [
                          { id: '4-2-3-1', label: 'Header.vue' },
                          { id: '4-2-3-2', label: 'Sidebar.vue' },
                          { id: '4-2-3-3', label: 'Footer.vue' }
                        ]
                      }
                    ]
                  },
                  { id: '4-3', label: 'package.json' }
                ]
              },
              {
                id: '5',
                label: '后端代码',
                children: [
                  { 
                    id: '5-1', 
                    label: 'controllers',
                    children: [
                      { id: '5-1-1', label: 'userController.js' },
                      { id: '5-1-2', label: 'productController.js' },
                      { id: '5-1-3', label: 'authController.js' }
                    ]
                  },
                  { 
                    id: '5-2', 
                    label: 'models',
                    children: [
                      { id: '5-2-1', label: 'userModel.js' },
                      { id: '5-2-2', label: 'productModel.js' }
                    ]
                  },
                  { 
                    id: '5-3', 
                    label: 'routes',
                    children: [
                      { id: '5-3-1', label: 'userRoutes.js' },
                      { id: '5-3-2', label: 'productRoutes.js' }
                    ]
                  },
                  { id: '5-4', label: 'server.js' }
                ]
              }
            ]
          },
          {
            title: '资源文件目录',
            icon: 'fas fa-images',
            expanded: true,
            expandedKeys: [],
            data: [
              {
                id: '6',
                label: '图片资源',
                children: [
                  { id: '6-1', label: 'logo.png' },
                  { id: '6-2', label: 'banner.jpg' },
                  { 
                    id: '6-3', 
                    label: 'icons',
                    children: [
                      { id: '6-3-1', label: 'home-icon.svg' },
                      { id: '6-3-2', label: 'user-icon.svg' },
                      { id: '6-3-3', label: 'settings-icon.svg' }
                    ]
                  }
                ]
              },
              {
                id: '7',
                label: '视频资源',
                children: [
                  { id: '7-1', label: 'intro.mp4' },
                  { id: '7-2', label: 'tutorial.mov' },
                  { id: '7-3', label: 'demo.avi' }
                ]
              },
              {
                id: '8',
                label: '音频资源',
                children: [
                  { id: '8-1', label: 'bgm.mp3' },
                  { id: '8-2', label: 'effect.wav' },
                  { id: '8-3', label: 'voice.ogg' }
                ]
              }
            ]
          }
        ]);
        
        // 树节点配置
        const defaultProps = {
          children: 'children',
          label: 'label'
        };
        
        // 过滤节点方法
        const filterNode = (value, data) => {
          if (!value) return true;
          return data.label.toLowerCase().includes(value.toLowerCase());
        };
        
        // 搜索处理
        const handleSearch = (value) => {
          treeRefs.value.forEach(tree => {
            if (tree) {
              tree.filter(value);
            }
          });
        };
        
        // 节点点击处理
        const handleNodeClick = (data) => {
          console.log('点击节点:', data);
        };
        
        // 切换单个树的展开/收缩
        const toggleTree = (index) => {
          const tree = treeData.value[index];
          tree.expanded = !tree.expanded;
          
          if (tree.expanded) {
            // 展开所有节点
            const getAllKeys = (nodes) => {
              let keys = [];
              nodes.forEach(node => {
                keys.push(node.id);
                if (node.children && node.children.length > 0) {
                  keys = keys.concat(getAllKeys(node.children));
                }
              });
              return keys;
            };
            tree.expandedKeys = getAllKeys(tree.data);
          } else {
            // 收缩所有节点
            tree.expandedKeys = [];
          }
          
          // 更新全局状态
          allExpanded.value = treeData.value.every(t => t.expanded);
        };
        
        // 切换所有树的展开/收缩
        const toggleAllTrees = () => {
          allExpanded.value = !allExpanded.value;
          treeData.value.forEach((tree, index) => {
            tree.expanded = allExpanded.value;
            
            if (allExpanded.value) {
              // 展开所有节点
              const getAllKeys = (nodes) => {
                let keys = [];
                nodes.forEach(node => {
                  keys.push(node.id);
                  if (node.children && node.children.length > 0) {
                    keys = keys.concat(getAllKeys(node.children));
                  }
                });
                return keys;
              };
              tree.expandedKeys = getAllKeys(tree.data);
            } else {
              // 收缩所有节点
              tree.expandedKeys = [];
            }
          });
        };
        
        return {
          searchText,
          allExpanded,
          treeData,
          defaultProps,
          treeRefs,
          setTreeRef,
          filterNode,
          handleSearch,
          handleNodeClick,
          toggleTree,
          toggleAllTrees
        };
      }
    }).use(ElementPlus).mount('#app');
  </script>
</body>
</html>
